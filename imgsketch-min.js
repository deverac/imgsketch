var imgSketch=function(){function t(t){return"c"==t.toLowerCase()}function e(t){return"l"==t.toLowerCase()}function r(t){return"x"==t.toLowerCase()}function o(t){return/[A-Z]/.test(t)}function i(t){return/[a-zA-Z]/.test(t)}function n(t){return"-"==t}function a(t){return t*Math.PI/180}function s(t){return o(t.kind)}function l(t){return o(t)}function c(e){return e.arc&&t(e.kind)&&!s(e)}function f(t,e){return{x:t.x*Math.cos(e)-t.y*Math.sin(e),y:t.y*Math.cos(e)+t.x*Math.sin(e),z:0}}function h(t,e){return f(function(t,e){return{x:t.x*Math.cos(e)+t.z*Math.sin(e),y:t.y,z:0}}(function(t,e){return{x:t.x,y:t.y*Math.cos(e)-t.z*Math.sin(e),z:0}}(t,e.x),e.y),e.z)}function u(){window.location.reload()}function x(t){var e=(t||"").split(",");return{a:Number(e[0])||0,b:Number(e[1])||0,c:Number(e[2])||0}}function d(t){var e=x(y(t,"dim"));return{w:e.a,h:e.b||e.a}}function p(t,e){return t[e]?t[e]:[]}function y(t,e){return p(t,e)[0]||""}function g(t,e){t.translate(e.offset.x,e.offset.y),t.rotate(e.rotate.z)}function m(t,e){t.rotate(-e.rotate.z),t.translate(-e.offset.x,-e.offset.y)}function z(t,e){return t.length>1?t:e[t.toLowerCase()]?e[t.toLowerCase()]:"000000"}function b(t,e){return t.substring(e,e+1)}function v(t,e){return e+(t.substring(e).match(/^[,]/)||[""])[0].length}function F(t,e){return e+(t.substring(e).match(/^[-]?\d+[.]?\d*/)||[""])[0].length}function w(t,e){var r=Object.assign({},e);return t.split(",").forEach(((t,e)=>{t&&(r[String.fromCharCode(e%26+97)]=("000000"+(parseInt(t,16)||"999999").toString(16)).slice(-6))})),r}function M(t,e,r){var o=[];if(2==e)o.push({x:t,y:0,z:0}),o.push({x:-t,y:0,z:0});else if(e){for(var i=a(360/e),n=0;n<e;n++)o.push({x:t*Math.cos(n*i),y:t*Math.sin(n*i),z:0});o=o.map((t=>f(t,(Math.PI-i)/2)))}else r.split("_").forEach((t=>{var e=t.split(",");o.push({x:parseInt(e[0]),y:parseInt(e[1]),z:0})}));return o}function E(t,r){var o,i,n=r.coords;if(t.beginPath(),1==n.length){var l=0,f=2*Math.PI;if(r.arc&&(r.arc=(o=r.arc,{beg:a((i=x(o)).a),end:a(i.b||360)}),c(r)&&t.moveTo(n[0].x,n[0].y),l=r.arc.beg,f=r.arc.end),r.rotate.x||r.rotate.y||r.rotate.z){var u=h({x:r.size,y:0,z:0},{x:r.rotate.x,y:r.rotate.y,z:0}),d=h({x:0,y:r.size,z:0},{x:r.rotate.x,y:r.rotate.y,z:0});g(t,r),t.ellipse(0,0,u.x,d.y,0,l,f),m(t,r)}else t.arc(r.offset.x,r.offset.y,r.size,l,f)}else t.moveTo(n[0].x,n[0].y),n.slice(1).forEach((e=>{t.lineTo(e.x,e.y)}));(c(r)||!s(r)&&(r.sides>1||"m"==r.kind.toLowerCase()))&&t.closePath(),r.fill&&!e(r.kind)?t.fill():t.stroke()}function k(t,e,r){var o,n,a,s=e.color||r.color,l=e.forceColor||z(s,r.colorDict);e.fill?t.fillStyle="#"+l:t.strokeStyle="#"+l,t.lineWidth=(o=e.linewidth,n=r.linewidth,a=n||3,i(o)&&(a=o.charCodeAt(0)-"a".charCodeAt(0)+1),Math.abs(a)),e.text?function(t,e,r){t.font=e.size+"px "+e.textFamily;var o=-e.textMetrics.maxWidth/2,i=e.textMetrics.lineHeight-e.textMetrics.lineHeight*e.textLines.length/2;g(t,e),e.textLines.forEach((r=>{e.fill?t.fillText(r,o,i):t.strokeText(r,o,i),i+=e.textMetrics.lineHeight})),m(t,e)}(t,e,r.family):E(t,e)}function C(t){var e={kind:b(t,0),color:"",offset:"",linewidth:"",size:"",flags:"",rotate:"",family:"",extra:""},r=1,o=b(t,r);if(!n(o)){e.color=i(o)?o:"",r+=e.color.length,e.offset=t.substring(r,function(t,e){const r=F(t,e),o=v(t,r);return r==o?o:F(t,o)}(t,r));var a=b(t,r+=e.offset.length);if(!n(a)&&(e.linewidth=a,!n(b(t,r+=e.linewidth.length)))){e.size=t.substring(r,F(t,r));var s=b(t,r+=e.size.length);if(!n(s)){e.flags=s,r+=e.flags.length,e.rotate=t.substring(r,function(t,e){const r=F(t,e),o=v(t,r);if(r==o)return o;const i=F(t,o),n=v(t,i);return i==n?n:F(t,n)}(t,r));var l=b(t,r+=e.rotate.length);n(l)||(e.family=l)}}}return e.extra=t.substring(r+1),e}function S(t,e,r){var o={coords:[],family:t.family,fill:!l(t.color),sides:0,size:parseInt(t.size)||e||20,text:t.extra};return o.textLines=o.text.split("~~").map((t=>t.replace(/-/g,"%20"))).map(decodeURIComponent)||"",o.textFamily=function(t){return"m"==t?"monospace":"s"==t?"serif":"sans-serif"}(o.family||r),o}function I(o,n,s){const c=F(o,0);var f,u,d,p,y,g,m,z,b,v=C(o.substring(c)),w=r(v.kind)?S(v,n.textsize,n.family):function(t,r){var o=function(t){switch(t.toLowerCase()){case"c":return 1;case"l":return 2;case"t":return 3;case"s":return 4;case"p":return 5;case"h":return 6;case"e":return 7;case"o":return 8;default:return 0}}(t.kind),n=parseInt(t.size)||r||40,a=Math.cos(Math.PI/o),s=n/(1==o||2==o?2:o%2?a+1:2*a);return{coords:M(s,o,t.extra),fill:!e(t.kind)&&(i(t.color)?l(t.color):void 0),sides:o,size:s}}(v,n.polysize);return w.scale=c>0?Number(o.substring(0,c)):1,w.kind=v.kind,w.color=v.color,w.offset=(f=v.offset,{x:(u=x(f)).a,y:u.b,z:0}),w.linewidth=v.linewidth,w.rotate=function(t){var e=x(t);return{z:a(e.a),y:a(e.b),x:a(e.c)}}(v.rotate),s&&(w.forceColor=s),e(w.kind)&&w.color&&(w.color=w.color.toLowerCase()),t(v.kind)&&(w.arc=v.extra),function(t){L(t,t.scale)}(w),function(t,e){e&&1!=e&&(L(t,e),t.offset.x*=e,t.offset.y*=e)}(w,n.scaleImg),r(v.kind)&&(w.textMetrics=(d=w.size,p=w.textFamily,y=n.textheight,g=w.textLines,m={lineHeight:0,maxWidth:0},z=document.getElementsByTagName("body")[0],(b=document.createElement("div")).innerHTML="X",b.style.position="absolute",b.style.top=0,b.style.left="-999px",b.style.padding=0,b.style.font=d+"px "+p,b.style.lineHeight=y,z.appendChild(b),m.lineHeight=b.offsetHeight,g.forEach((t=>{b.innerHTML=t.replace(/ /g,"&nbsp;"),b.offsetWidth>m.maxWidth&&(m.maxWidth=b.offsetWidth)})),z.removeChild(b),m),(n.palette||n.help)&&(w.offset.x+=w.textMetrics.maxWidth/2,w.offset.y+=w.textMetrics.lineHeight*w.textLines.length/2)),w.coords=t(w.kind)?[{x:w.offset.x,y:w.offset.y,z:0}]:w.coords.map((t=>h(t,w.rotate))).map((t=>{return e=t,r=w.offset,{x:e.x+r.x,y:e.y+r.y,z:e.z};var e,r})),w}function A(t){pgons=[];var e=["Parameters:","  bg=[a-z]           Background color","  color=[a-z]        Drawing color","  colord=000000,...  Define colors for color dict","  cxz=000000,000000  Specify colors for 'x' and 'z'","  dim=x,y            Image dimensions; y is optional","  family=[m,n,s]     Text family","  help=1             Show this help","  linewidth=[a-z]    Linewidth of shapes","  pad=n              Padding","  palette=[1,2]      Show full or simple color palette","  polysize=n         Size of polygons","  reload=n           Auto-reload page after n seconds","  scaleimg=n         Scale whole image","  textheight=n       Height of text line","  textsize=n         Size of text","  z=...              Z-Fields","  zN=...             Z-Field layer; N must be 1-9","","Z-Fields: Scale Shape Color Offset Linewidth Size Flag Rotate Family Extra","      Scale: n","      Shape: c,l,t,s,p,h,e,o,x,m (Capitalize for open polygon)","      Color: a-z (Capitalize to fill shape)","     Offset: x,y","  Linewidth: a-z,_","       Size: n","       Flag: _","     Rotate: z,y,x (Degrees)","     Family: m,n,s,_ (Monospace, Sans-serif, Serif, Default)","      Extra: Arc OR XYPoints OR Text","Arc is 'begin,end' in degrees","XYPoints is 'x1,y1_x2,y2_...'","For Text, '~~' is newline, '-' is space, '%nn' is ASCII char","For Shape 'c', 'm', or 'x', skip to Extra with '-'","","Examples:"," tR5,2b70_9      R=Red fill; 5,2=offset; b=linewidth(2); 70=size; 9=rotate"," x4,9-Hi~~World  4,9=offset; -=Skip to Extra; Hi~~World=text"," x8,9__sHello    8,9=offset; s=Serif; Hello=text"," c9,7_30-45,99   9,7=offset; 30=size; -=Skip to Extra; 45,99=arc",""].map(encodeURIComponent).map((t=>t.replace(/~/g,"%7E"))).map((t=>t.replace(/-/g,"%2D"))).join("~~");return pgons.push(I("x0,0__m"+e,t,null)),pgons}function D(e,o){var i,n,a,s=(i={},o.split("&").forEach((t=>{var e=t.split("=");i[e[0]]||(i[e[0]]=[]),i[e[0]].push(e[1])})),i),l=function(t,e){return{bg:y(t,"bg")||"w",color:y(t,"color"),colorDict:w(y(t,"colord"),e),cxzDict:w(y(t,"cxz"),{}),dim:d(t),family:y(t,"family"),help:parseInt(y(t,"help")),linewidth:y(t,"linewidth"),pad:parseInt(y(t,"pad")),palette:parseInt(y(t,"palette")),polysize:parseInt(y(t,"polysize")),secs:1e3*Math.abs(Number(y(t,"reload"))||0),scaleImg:Number(y(t,"scaleimg"))||0,textheight:y(t,"textheight"),textsize:parseInt(y(t,"textsize"))}}(s,{a:"8B8680",b:"4F69C6",c:"6456B7",d:"FF8833",e:"FFAE42",f:"FED85D",g:"01A638",h:"F1E788",i:"C5E17A",j:"0095B7",k:"000000",l:"02A4D3",m:"FD0E35",n:"AF593E",o:"FF681F",p:"FFA6C9",q:"BB3385",r:"ED0A3F",s:"F7468A",t:"0066FF",u:"FDD5B1",v:"8359A3",w:"FFFFFF",y:"FBE870"});l.cxzDict&&(n=l.cxzDict,a=l.colorDict,n.a&&(a.x=n.a),n.b&&(a.z=n.b));var c=[];c=l.help?A(l):l.palette?function(t){var e=[],r=t.polysize||100,o=t.textsize||30,i=2==t.palette?"roygbvwpank".split(""):Object.keys(t.colorDict).sort();return t.dim={w:6*r+2*t.pad,h:r*Math.ceil(i.length/6)+2*t.pad},i.forEach(((i,n)=>{var a=parseInt(r/2),s=parseInt(n*r%(6*r)+a),l=parseInt(Math.floor(n/6)*r+a);e.push(I("s"+i.toUpperCase()+s+","+l+"_"+r,t,null)),s-=a,l-=a,e.push(I("x"+s+","+l+"_"+o+"_m"+i,t,"000000")),e.push(I("x"+s+","+l+"_"+o+"_m-"+i,t,"FFFFFF"))})),e}(l):function(t,e){for(var r=[],o=0;o<10;o++)p(t,"z"+(0==o?"":o)).forEach((t=>{var o=I(t,e,null);(o.coords.length||o.text)&&r.push(o)}));return r}(s,l),function(t,e){var r=e||0;t.forEach((t=>{t.coords.forEach((t=>{t.x+=r,t.y+=r})),t.offset.x+=r,t.offset.y+=r}))}(c,l.pad),function(e,o,i,n,a){if(n=n||0,i.w)a&&1!=a&&(i.w*=a,i.h*=a);else{var s={x:0,y:0};o.forEach((e=>{if(t(e.kind))e.offset.x+e.size>s.x&&(s.x=e.offset.x+e.size),e.offset.y+e.size>s.y&&(s.y=e.offset.y+e.size);else if(r(e.kind)){var o={x:e.textMetrics.maxWidth/2,y:-e.textMetrics.lineHeight*e.textLines.length/2,z:0},i=f(o,e.rotate.z);o.y=-o.y;var n=f(o,e.rotate.z);i.x=Math.abs(i.x),i.y=Math.abs(i.y),n.x=Math.abs(n.x),n.y=Math.abs(n.y);var a=e.offset.x+Math.max(i.x,n.x);a>s.x&&(s.x=a);var l=e.offset.y+Math.max(i.y,n.y);l>s.y&&(s.y=l)}else e.coords.forEach((t=>{t.x>s.x&&(s.x=t.x),t.y>s.y&&(s.y=t.y)}))})),i={w:s.x+n,h:s.y+n}}e.setAttribute("width",i.w||1),e.setAttribute("height",i.h||1)}(e,c,l.dim,l.pad,l.scaleImg),function(t,e){if(e){var r=t.getContext("2d");r.fillStyle="#"+e,r.fillRect(0,0,t.width,t.height)}}(e,z(l.bg,l.colorDict)),function(t,e,r){var o=t.getContext("2d");e.forEach((t=>k(o,t,r)))}(e,c,l),l.secs&&setTimeout(u,l.secs)}function L(e,o){o&&1!=o&&(e.coords.forEach((t=>{t.x*=o,t.y*=o})),(t(e.kind)||r(e.kind))&&(e.size*=o))}return{init:function(t,e){var r=t||"pgon",o=e||"data-src";document.querySelectorAll("img."+r).forEach((t=>{var e=document.createElement("canvas");const r=t.hasAttribute(o)?t.getAttribute(o):t.getAttribute("src");r&&(D(e,r.split("?")[1]||""),t.src=e.toDataURL("image/png"))}))}}}();